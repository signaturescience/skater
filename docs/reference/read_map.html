<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read genetic map file — read_map • skater</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read genetic map file — read_map"><meta property="og:description" content='This function reads in the content from a genetic map file to translate physical distance to genetic units (i.e. cM). Regardless of the source, the input file must be sex-averaged and in a tab-separated "Plink" format (documentation) with the following four columns and no header (i.e. no column names):
Chromosome
Identifier (ignored in read_map())
Length (genetic length within the physical position boundary)
Position (physical position boundary)


The columns must be in the order above. Note that only the first, third, and fourth columns are used in the function.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">skater</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic_usage.html">Basic Usage</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/signaturescience/skater/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read genetic map file</h1>
    <small class="dont-index">Source: <a href="https://github.com/signaturescience/skater/blob/HEAD/R/read.R" class="external-link"><code>R/read.R</code></a></small>
    <div class="hidden name"><code>read_map.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reads in the content from a genetic map file to translate physical distance to genetic units (i.e. cM). Regardless of the source, the input file must be sex-averaged and in a tab-separated "Plink" format (<a href="http://zzz.bwh.harvard.edu/plink/data.shtml#map" class="external-link">documentation</a>) with the following four columns and no header (i.e. no column names):</p><ol><li><p>Chromosome</p></li>
<li><p>Identifier (ignored in <code>read_map()</code>)</p></li>
<li><p>Length (genetic length within the physical position boundary)</p></li>
<li><p>Position (physical position boundary)</p></li>
</ol><p>The columns must be in the order above. Note that only the first, third, and fourth columns are used in the function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_map</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>file</dt>
<dd><p>Input file path</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A tibble containing 3 columns:</p><ol><li><p>chr (chromosome)</p></li>
<li><p>value (genetic length within the physical position boundary)</p></li>
<li><p>bp (physical position boundary)</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>The genetic map could come from different sources. One source is the HapMap map distributed by the Browning Lab (<a href="http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/" class="external-link">documentation</a>). If this map file is used, the non-sex chromosomes can be downloaded and concatenated to a single file as follows:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wget http<span class="sc">:</span><span class="er">//</span>bochet.gcc.biostat.washington.edu<span class="sc">/</span>beagle<span class="sc">/</span>genetic_maps<span class="sc">/</span>plink.GRCh37.map.zip</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>unzip plink.GRCh37.map.zip</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cat <span class="sc">*</span>chr[<span class="dv">0-9</span>]<span class="sc">*</span>GRCh37.map <span class="sc">|</span> sort <span class="sc">-</span>k1,<span class="dv">1</span> <span class="sc">-</span>k4,<span class="dv">4</span> <span class="sc">--</span>numeric<span class="sc">-</span>sort <span class="sc">&gt;</span> plink.allchr.GRCh37.map</span></code></pre><p></p></div>
<p>Another source is a sex-specific map ("bherer") originally published by Bherer et al and recommended by the developers of <code>ped-sim</code> for simulating IBD segments (<a href="https://github.com/williamslab/ped-sim#map-file" class="external-link">documentation</a>). To retrieve and prep this map file for simulation:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the refined genetic map and extract</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>wget <span class="sc">--</span>no<span class="sc">-</span>check<span class="sc">-</span>certificate https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>cbherer<span class="sc">/</span>Bherer_etal_SexualDimorphismRecombination<span class="sc">/</span>raw<span class="sc">/</span>master<span class="sc">/</span>Refined_genetic_map_b37.tar.gz</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tar xvfpz Refined_genetic_map_b37.tar.gz</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for ped-sim as per https://github.com/williamslab/ped-sim#map-file-</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>printf <span class="st">"#chr</span><span class="sc">\t</span><span class="st">pos</span><span class="sc">\t</span><span class="st">male_cM</span><span class="sc">\t</span><span class="st">female_cM</span><span class="sc">\n</span><span class="st">"</span> <span class="sc">&gt;</span> sexspec.pedsim.map</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="cf">in</span> {<span class="dv">1</span>..<span class="dv">22</span>}; do</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  paste Refined_genetic_map_b37<span class="sc">/</span>male_chr<span class="sc">$</span>chr.txt Refined_genetic_map_b37<span class="sc">/</span>female_chr<span class="sc">$</span>chr.txt \</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">|</span> awk <span class="sc">-</span>v OFS<span class="ot">=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span> <span class="st">'NR &gt; 1 &amp;&amp; $2 == $6 {print $1,$2,$4,$8}'</span> \</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">|</span> sed <span class="st">'s/^chr//'</span> <span class="sc">&gt;</span><span class="er">&gt;</span> sexspec.pedsim.map;</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>done</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>rm <span class="sc">-</span>rf Refined_genetic_map_b37<span class="sc">*</span></span></code></pre><p></p></div>
<p>After this, the <code>sexspec.pedsim.map</code> file is ready for use in simulation. However, it must be averaged and reformatted to "Plink format" to use here:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cat sexspec.pedsim.map <span class="sc">|</span> grep <span class="sc">-</span>v <span class="st">"^#"</span> <span class="sc">|</span> awk <span class="sc">-</span>v OFS<span class="ot">=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span> <span class="st">'{print $1,".",($3+$4)/2,$2}'</span> <span class="sc">&gt;</span> sexspec<span class="sc">-</span>avg.plink.map</span></code></pre><p></p></div>
<p>#' The genetic maps created above are in the tens of megabytes size range. This is trivial to store for most systems but a reduced version would increase portability and ease testing. This "minimum viable genetic map" could be used for testing and as installed package data in an R package for example analysis. Read more about minimum viable genetic maps at:</p><ul><li><p>Blog post: <a href="https://hapi-dna.org/2020/11/minimal-viable-genetic-maps/" class="external-link">https://hapi-dna.org/2020/11/minimal-viable-genetic-maps/</a></p></li>
<li><p>Github repo with python code: <a href="https://github.com/williamslab/min_map" class="external-link">https://github.com/williamslab/min_map</a></p></li>
</ul><p>The code as written below reduces the averaged sex-specific genetic map from 833776 to 28726 positions (~30X reduction!).</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get minmap script from github</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>wget https<span class="sc">:</span><span class="er">//</span>raw.githubusercontent.com<span class="sc">/</span>williamslab<span class="sc">/</span>min_map<span class="sc">/</span>main<span class="sc">/</span>min_map.py</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create empty minmap</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>echo <span class="sc">-</span>n <span class="sc">&gt;</span> sexspec<span class="sc">-</span>avg<span class="sc">-</span>min.plink.map</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For each autosome...</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chr <span class="cf">in</span> {<span class="dv">1</span>..<span class="dv">22</span>}; do</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  echo <span class="st">"Working on chromosome $chr..."</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First pull out just one chromosome</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  grep <span class="st">"^${chr}[[:space:]]"</span> sexspec<span class="sc">-</span>avg.plink.map <span class="sc">&gt;</span> tmp.<span class="sc">$</span>{chr}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run the python script on that chromosome.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The genetic map column is 3rd column (2nd in 0-start). Physical position is last column (3 in 0-based)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  python3 min_map.py <span class="sc">-</span>mapfile tmp.<span class="sc">$</span>{chr} <span class="sc">-</span>chr <span class="sc">$</span>{chr} <span class="sc">-</span>genetcol <span class="dv">2</span> <span class="sc">-</span>physcol <span class="dv">3</span> <span class="sc">-</span>noheader <span class="sc">-</span>error <span class="fl">0.05</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Strip out the header and reformat back to plink format, and append to minmap file</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  cat min_viable_map<span class="sc">$</span>{chr}.txt <span class="sc">|</span> grep <span class="sc">-</span>v <span class="st">"^#"</span> <span class="sc">|</span> awk <span class="sc">-</span>v OFS<span class="ot">=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span> <span class="st">'{print $1,".",$4,$2}'</span> <span class="sc">&gt;</span><span class="er">&gt;</span> sexspec<span class="sc">-</span>avg<span class="sc">-</span>min.plink.map</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  rm <span class="sc">-</span>f min_viable_map<span class="sc">$</span>{chr}.txt tmp.<span class="sc">$</span>{chr}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>done</span></code></pre><p></p></div>
<p>This averaged version of the Bherer sex-specific map, reduced to a minimum viable genetic map with at most 5% error, in Plink format, is available as installed package data (see examples). This is useful for testing code, but the full genetic map should be used for most analysis operations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><a href="http://zzz.bwh.harvard.edu/plink/data.shtml#map" class="external-link">http://zzz.bwh.harvard.edu/plink/data.shtml#map</a></p>
<p><a href="http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/" class="external-link">http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/</a></p>
<p><a href="https://github.com/williamslab/ped-sim#map-file" class="external-link">https://github.com/williamslab/ped-sim#map-file</a></p>
<p><a href="https://www.nature.com/articles/ncomms14994" class="external-link">https://www.nature.com/articles/ncomms14994</a></p>
<p><a href="https://www.nature.com/articles/ncomms14994" class="external-link">https://www.nature.com/articles/ncomms14994</a></p>
<p><a href="https://github.com/cbherer/Bherer_etal_SexualDimorphismRecombination" class="external-link">https://github.com/cbherer/Bherer_etal_SexualDimorphismRecombination</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">gmapfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sexspec-avg-min.plink.map"</span>, package<span class="op">=</span><span class="st">"skater"</span>, mustWork<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gmap</span> <span class="op">&lt;-</span> <span class="fu">read_map</span><span class="op">(</span><span class="va">gmapfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stephen Turner, Matthew Scholz, VP Nagraj.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

